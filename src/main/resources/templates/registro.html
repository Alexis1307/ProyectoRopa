<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Registro de Movimientos</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="bg-light">


	<nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm w-100">
		  <div class="container-fluid">
		    <a class="navbar-brand fw-bold text-white" href="/producto/lista">El rincÃ³n de la calidad</a>

		    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
		      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
		      <span class="navbar-toggler-icon"></span>
		    </button>

		    <div class="collapse navbar-collapse" id="navbarNav">
		      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
		        <li class="nav-item"><a class="nav-link text-white" href="/producto/lista">Home</a></li>

		        <li class="nav-item dropdown">
		          <a class="nav-link dropdown-toggle text-white" href="#" id="buscarDropdown" role="button"
		             data-bs-toggle="dropdown" aria-expanded="false">Buscar</a>
		          <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="buscarDropdown">
		            <li><a class="dropdown-item" href="#" onclick="mostrarBuscador('producto')">Buscar Producto</a></li>
		            <li><a class="dropdown-item" href="#" onclick="mostrarBuscador('proveedor')">Buscar Proveedor</a></li>
		          </ul>
		        </li>

		        <!-- âœ… NUEVO BOTÃ“N AGREGADO -->
		        <li class="nav-item">
		          <a class="nav-link text-warning fw-bold" href="/registro">ðŸ“œ Ver Movimientos</a>
		        </li>
		        <!-- âœ… FIN NUEVO BOTÃ“N -->
		      </ul>

		      <ul class="navbar-nav ms-auto">
		        <li class="nav-item dropdown">
		          <a class="nav-link dropdown-toggle text-white" href="#" id="userDropdown" role="button"
		             data-bs-toggle="dropdown" aria-expanded="false">ðŸ‘¤</a>
		          <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end" aria-labelledby="userDropdown">
		            <li><a class="dropdown-item" href="#">Perfil</a></li>
		            <li><a class="dropdown-item" href="/login">Cerrar SesiÃ³n</a></li>
		          </ul>
		        </li>
		      </ul>
		    </div>
		  </div>
		</nav>

		<div id="contenedorBuscador" class="container my-3" style="display:none;">
		  <form id="formBuscador" method="get" class="d-flex gap-2">
		    <input type="text" id="inputBusqueda" name="razonSocial" class="form-control" placeholder="Buscar..." required>
		    <button type="submit" class="btn btn-outline-light bg-dark border-light">Buscar</button>
		  </form>
		</div>

		<script>
		  function mostrarBuscador(tipo) {
		    const form = document.getElementById('formBuscador');
		    const cont = document.getElementById('contenedorBuscador');
		    const input = document.getElementById('inputBusqueda');
		    
		    cont.style.display = 'block';
		    form.action = '/' + tipo + '/buscar';
		    
		    // cambia el nombre del parÃ¡metro segÃºn el tipo
		    input.name = (tipo === 'producto') ? 'nombre' : 'razonSocial';
		  }
		</script>

<div class="container mt-5">
  <h2 class="fw-bold text-center mb-4 text-dark">ðŸ“‹ Registro de Movimientos Administrativos</h2>

  <div class="card shadow-lg rounded-4 border-0">
    <div class="card-body">
      <table class="table table-hover align-middle table-bordered">
        <thead class="table-dark">
          <tr class="text-center">
            <th>ID</th>
            <th>Usuario</th>
            <th>AcciÃ³n</th>
            <th>Entidad</th>
            <th>Detalle</th>
            <th>Fecha y Hora</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="mov : ${movimientos}">
            <td th:text="${mov.id}"></td>
            <td th:text="${mov.usuario}"></td>
            <td th:text="${mov.accion}"></td>
            <td th:text="${mov.entidad}"></td>
            <td th:text="${mov.detalle}"></td>
            <td th:text="${#temporals.format(mov.fechaHora, 'dd/MM/yyyy HH:mm:ss')}"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

</body>
</html>
